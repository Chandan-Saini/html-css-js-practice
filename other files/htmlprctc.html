<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>udemy JS practice</title>

    <style></style>
  </head>

  <body>
    <h1>
      practice of ES6 JS AJAX
    </h1>

    <script>
      // old way to work with asynchronous JS
      //  function getRecipe(){
      //      setTimeout(() => {
      //        recipeID=[234,546,977,435]
      //        console.log(recipeID);

      //        setTimeout((id) => {
      //           const recipe={title:"Fresh tomato",publisher:"Jonas"}

      //           console.log(`${id}: ${recipe.title}`);

      //           setTimeout(publisher => {
      //             const recipe2= {title:"cheese pizza", publisher:"Jonas"}
      //              console.log(recipe2);

      //           }, 1500, recipe.publisher);

      //        }, 1500,recipeID[2]);
      //      }, 1500);
      //  }

      //  getRecipe()

      // new way to work with Ajax using promises

      const getIDs = new Promise((resolve, reject) => {
        setTimeout(() => {
          resolve([234, 546, 977, 435]);
          // reject()
        }, 1500);
      });

      const getRecipe = (recId) => {
        return new Promise((resolve, reject) => {
          setTimeout(
            (id) => {
              let recipe = { title: "green pasta", publisher: "chan" };
              resolve(`${id}: ${recipe.title}`);
            },
            1500,
            recId
          );
        });
      };

      const getPub = (pub) => {
        return new Promise((resolve, reject) => {
          setTimeout(
            (pub) => {
              let recipe2 = { title: "chilli chicken", publisher: "chan" };
              resolve(`publisher is ${pub}`);
            },
            1500,
            pub
          );
        });
      };

      // consuming promises
      // getIDs
      //   .then((id) => {
      //     console.log(id);
      //     return getRecipe(id[2]);
      //   })
      //   .then(res => {
      //     console.log(res);
      //     return getPub("Chandan")
      //   })
      //   .then(res=>{
      //     console.log(res);
      //   })
      //   .catch(() => {
      //     console.log("some error occured");
      //   });

      //consuming promises using Await function
      async function getRecipeAW() {
        const getID = await getIDs;
        console.log(getID);

        const recipe = await getRecipe(getID[2]);
        console.log(recipe);

        const pub = await getPub("chandan");
        console.log(pub);

        return recipe;
      }

      //  var result= getRecipeAW();
      //  console.log(result);
      //this code will not work because this is a synchronous code and it will run before getRecipeAW()

      getRecipeAW().then((result) => console.log(result)); //to use return val from a async function we nee dto use then()
    </script>
  </body>
</html>
